from osgeo import osr, ogr
from visuallayer import *
from FindSeismogenicSources import *
from FindEmergencySources import *

if __name__ == '__main__':
    p1 = 'POLYGON((13.5068345450051 42.453405113893 0, 13.4096230499813 42.4523491454874 0, 13.2115443247965 42.4064643249082 0, 13.1851261157124 42.3844347578868 0, 13.1862671506709 42.337148180385 0, 13.2258412924453 42.2526387443975 0, 13.2423197602569 42.2312002178368 0, 13.3705863707811 42.1833929419606 0, 13.4698105487939 42.19658686572 0, 13.5302690593105 42.2821405484086 0, 13.5230236642177 42.3785610045857 0, 13.5068345450051 42.453405113893 0))'
    p2 = 'POLYGON((14.2465962015719 42.3462559641075 0, 14.2859920854647 42.4805859828347 0, 14.256855338585 42.5160452907775 0, 14.1304330010751 42.5061116162797 0, 14.1123300163194 42.4770935608544 0, 14.1465913235078 42.4101315155575 0, 14.1780504262123 42.3621534094607 0, 14.2465962015719 42.3462559641075 0))'
    p3 = 'POLYGON((12.422396050106 41.9597877695711 0, 12.4823766713468 41.8396081631992 0, 12.5776376377442 41.8810792934836 0, 12.6420591272299 41.9553531260793 0, 12.6459359418536 41.9955660354004 0, 12.4808692513795 42.0213784609936 0, 12.4510442020462 42.0256345467169 0, 12.429211361642 42.0279834829955 0, 12.422396050106 41.9597877695711 0))'
    p4 = 'POLYGON((13.6289949256827 42.5530960232256 0, 13.7778745145475 42.5856347944146 0, 13.7654694564848 42.667358586897 0, 13.6942330876273 42.7811639905155 0, 13.6351124442189 42.7394211401667 0, 13.6132295136819 42.7203354083481 0, 13.5946219685106 42.6919874190885 0, 13.6068964812642 42.628919077663 0, 13.6289949256827 42.5530960232256 0))'

    polygon1 = ogr.CreateGeometryFromWkt(p1)
    polygon2 = ogr.CreateGeometryFromWkt(p2)
    polygon3 = ogr.CreateGeometryFromWkt(p3)
    polygon4 = ogr.CreateGeometryFromWkt(p4)
    polygons = [polygon1, polygon2, polygon3, polygon4]

    n = 6  # number of possible sources

    seismogenic_area = find_seismogenic_area(polygons, n)
    emergency_area = find_emergency_area(seismogenic_area)

    #To find the polygons of the emergency and seismogenic sources
    seismogenic_sources = find_n_candidate_sources(polygons,n)
    emergency_sources = find_emergency_sources(seismogenic_area)

    #To find the total area
    total_area = find_interested_area(seismogenic_area, emergency_area)

    print (total_area)

    plot_rings(total_area, edgecolor="black",fillcolor="grey",
                 holeedgecolor='red',holefillcolor='white',
                    alpha=1,linewidth=0.7,fill=False)

    plt.show()
